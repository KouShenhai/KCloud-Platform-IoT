---
title: é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘
date: 2023-09-26 12:20:19
permalink: /pages/10bfa7/
---

ä½ å¥½å‘€ï¼Œæˆ‘çš„è€æœ‹å‹ï¼æˆ‘æ˜¯è€å¯‡ï¼Œæ¬¢è¿æ¥åˆ°è€å¯‡äº‘å¹³å°ï¼

## ç¯å¢ƒæ­å»º

ä¿®æ”¹winç³»ç»Ÿä¸Šé¢çš„hosts(<font color="red">å¦‚æœ‰éœ€è¦ï¼Œè¯·è‡ªè¡Œæ›´æ¢IPï¼Œæ¯”å¦‚è¯´ä½¿ç”¨äº‘æœåŠ¡ï¼Œè¯·æ›´æ¢æˆäº‘æœåŠ¡å™¨IP</font>)ã€ç›®å½•ä½ç½®ï¼š<font color="red">C:\Windows\System32\drivers\etc\hosts</font>ã€‘

```shell
127.0.0.1 rocketmq-namesrv
127.0.0.1 redis
127.0.0.1 postgresql
127.0.0.1 nginx
127.0.0.1 elasticsearch
127.0.0.1 nacos
127.0.0.1 kafka
127.0.0.1 sentinel
127.0.0.1 gateway
127.0.0.1 tdengine
127.0.0.1 job
127.0.0.1 auth
127.0.0.1 admin
127.0.0.1 jaeger-collector
127.0.0.1 otel-collector
127.0.0.1 ui
127.0.0.1 arthas-server
127.0.0.1 seata
127.0.0.1 loki
127.0.0.1 react
```

[windowå®‰è£…dockeræ•™ç¨‹](https://kcloud.blog.csdn.net/article/details/123039609)

æ³¨æ„ï¼š<font color="red">æœ¬æ•™ç¨‹ä¸ºwindowç³»ç»Ÿçš„dockerï¼Œå…¶ä½™ç¯å¢ƒè¯·è‡ªè¡Œå®‰è£…</font>

æ³¨æ„ï¼š<font color="red">windowç³»ç»Ÿè‡ªå¸¦docker-composeï¼Œæ— éœ€å®‰è£…</font>

æ³¨æ„ï¼š<font color="red">å…ˆè·‘èµ·æ¥ï¼Œä¸è¦æ”¹ä»»ä½•çš„å¯†ç ï¼Œè¯·ä¸è¦æ“…ä½œä¸»å¼ çš„ä¿®æ”¹ï¼Œå¦‚æœç…§ç€æ•™ç¨‹è¿è¡Œï¼Œè¿˜æœ‰é—®é¢˜è¯·è”ç³»ä½œè€…</font>

æ³¨æ„ï¼š<font color="red">æœ¬æ•™ç¨‹ä¸ºwindowç³»ç»Ÿçš„dockerï¼Œå…¶ä½™ç¯å¢ƒè¯·è‡ªè¡Œå®‰è£…</font>

```shell
services:
  postgresql:
    image: timescale/timescaledb:latest-pg17
    container_name: postgresql
    # ä¿æŒå®¹å™¨åœ¨æ²¡æœ‰å®ˆæŠ¤ç¨‹åºçš„æƒ…å†µä¸‹è¿è¡Œ
    tty: true
    restart: always
    privileged: true
    ports:
      - "5432:5432"
    volumes:
      - ./postgresql17/data:/var/lib/postgresql/data
    environment:
      - POSTGRES_USER=root
      - POSTGRES_PASSWORD=laokou123
      - TZ=Asia/Shanghai
    networks:
      - laokou_network
  redis:
    image: redis:7.4.2
    container_name: redis
    # ä¿æŒå®¹å™¨åœ¨æ²¡æœ‰å®ˆæŠ¤ç¨‹åºçš„æƒ…å†µä¸‹è¿è¡Œ
    tty: true
    restart: always
    privileged: true
    ports:
      - "6379:6379"
    volumes:
      - ./redis7/conf/redis.conf:/etc/redis/redis.conf
      - ./redis7/data:/data
    command: redis-server --appendonly yes --requirepass 'laokou123'
    environment:
      - TZ=Asia/Shanghai
    networks:
      - laokou_network
  rocketmq-namesrv:
    image: apache/rocketmq:5.3.1
    container_name: rocketmq-namesrv
    # ä¿æŒå®¹å™¨åœ¨æ²¡æœ‰å®ˆæŠ¤ç¨‹åºçš„æƒ…å†µä¸‹è¿è¡Œ
    tty: true
    restart: always
    privileged: true
    ports:
      - "9876:9876"
    command: sh mqnamesrv
    environment:
      - JAVA_OPT_EXT=-server -Xmx512m -Xms512m -Xmn256m
      - TZ=Asia/Shanghai
    networks:
      - laokou_network
  rocketmq-broker:
    image: apache/rocketmq:5.3.1
    container_name: rocketmq-broker
    # ä¿æŒå®¹å™¨åœ¨æ²¡æœ‰å®ˆæŠ¤ç¨‹åºçš„æƒ…å†µä¸‹è¿è¡Œ
    tty: true
    restart: always
    privileged: true
    ports:
      - "10909:10909"
      - "10911:10911"
      - "10912:10912"
    # è‡ªåŠ¨åˆ›å»ºä¸»é¢˜
    command: sh mqbroker -n rocketmq-namesrv:9876 -c /home/rocketmq/conf/broker.conf autoCreateTopicEnable=true
    environment:
      - JAVA_OPT_EXT=-server -Xmx512m -Xms512m -Xmn256m
      - TZ=Asia/Shanghai
    volumes:
      - ./rocketmq5/broker/conf/broker.conf:/home/rocketmq/conf/broker.conf
      # æŒ‚è½½æ•°æ®
      - ./rocketmq5/broker/store:/home/rocketmq/store
      # æŒ‚è½½æ—¥å¿—
      - ./rocketmq5/broker/logs:/home/rocketmq/logs
    networks:
      - laokou_network
    depends_on:
      - rocketmq-namesrv
  # é»˜è®¤è´¦å·/å¯†ç  => admin/admin
  portainer:
   image: portainer/portainer-ce:latest
   container_name: portainer
   # ä¿æŒå®¹å™¨åœ¨æ²¡æœ‰å®ˆæŠ¤ç¨‹åºçš„æƒ…å†µä¸‹è¿è¡Œ
   tty: true
   restart: always
   privileged: true
   ports:
     - "9010:9000"
   volumes:
     - /var/run/docker.sock:/var/run/docker.sock
     - ./portainer/data:/data
   networks:
     - laokou_network
networks:
  laokou_network:
    driver: bridge
```

æ³¨æ„ï¼š<font color="red">å¤åˆ¶åˆ°æŒ‡å®šç›®å½•ï¼Œç„¶åå¯åŠ¨æœåŠ¡ã€éœ€è¦æˆæƒã€‘</font>

```shell
# Ubuntuæˆæƒ
chmod -R 7777 ç›®å½•
```

<div style="width: 100%"><img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img.png"></div>

æ³¨æ„ï¼š<font color="red">éœ€è¦ä¿®æ”¹rocketmqçš„broker.confé…ç½®ï¼Œå°†brokerIP1æ”¹ä¸ºè‡ªå·±çš„æœ¬åœ°IP</font>

<div style="width: 100%"><img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_1.png"></div>

```shell
# å¯åŠ¨æœåŠ¡
docker-compose up - d
```

è®¿é—®ã€dockerå¯è§†åŒ–ç•Œé¢ã€‘http://localhost:9010

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_13.png">

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_14.png">

## è§†é¢‘åœ°å€

[è€å¯‡äº‘å¹³å°-é¡¹ç›®æ¼”ç¤ºè§†é¢‘](https://www.bilibili.com/video/BV16M411C7v7)

## é¡¹ç›®è¿è¡Œï¼ˆè¯·ä¸€å®šæŒ‰ç…§ä½œè€…çš„æ­¥éª¤æ¥ï¼‰

æ³¨æ„ï¼š<font color="red">Maven ç‰ˆæœ¬è¯·ä½¿ç”¨3.9.x</font>

æ³¨æ„ï¼š<font color="red">Maven ç‰ˆæœ¬è¯·ä½¿ç”¨3.9.x</font>

æ³¨æ„ï¼š<font color="red">Maven ç‰ˆæœ¬è¯·ä½¿ç”¨3.9.x</font>


ğŸš€ è½¯ä»¶ç‰ˆæœ¬
<table>
    <tr>
        <th>è½¯ä»¶åç§°</th>
        <th>è½¯ä»¶ç‰ˆæœ¬</th>
    </tr>
    <tr>
        <td>JDK</td>
        <td>21</td>
    </tr>
    <tr>
        <td>Maven</td>
        <td>3.9.4</td>
    </tr>
    <tr>
        <td>TimescaleDB</td>
        <td>17</td>
    </tr>
    <tr>
        <td>Redis</td>
        <td>7.2.4</td>
    </tr>
    <tr>
        <td>RocketMQ</td>
        <td>5.3.1</td>
    </tr>
</table>

ğŸš€ é¡¹ç›®æ‹‰å–ï¼ˆå®‰è£…gitï¼‰

- é¡¹ç›®ç›®å½•é‡Œé¢ä¸èƒ½å¸¦ä¸­æ–‡
- é¡¹ç›®ç›®å½•é‡Œé¢ä¸èƒ½å¸¦ä¸­æ–‡
- é¡¹ç›®ç›®å½•é‡Œé¢ä¸èƒ½å¸¦ä¸­æ–‡

sshæ–¹å¼æ‹‰å–ï¼ˆæ¨èï¼‰

```shell
git clone git@github.com:KouShenhai/KCloud-Platform-IoT.git
```

httpsæ–¹å¼

```shell
git clone https://github.com/KouShenhai/KCloud-Platform-IoT.git
```

ğŸš€ é¡¹ç›®æ‰“åŒ…ï¼Œç¡®ä¿é¡¹ç›®èƒ½æ­£å¸¸ç¼–è¯‘

```shell
# é¡¹ç›®æ‰“åŒ…
mvn clean install -P dev -DskipTests
```

ğŸš€ åˆå§‹åŒ–æ•°æ®åº“
- kcloud_platform.sql ã€ç³»ç»Ÿç®¡ç†ã€‘
- kcloud_platform_domain.sql ã€é¢†åŸŸäº‹ä»¶ã€‘
- kcloud_platform_iot.sql ã€ç‰©è”ç®¡ç†ã€‘
- kcloud_platform_nacos.sql ã€Nacosã€‘
- kcloud_platform_generator.sql ã€ä»£ç ç”Ÿæˆã€‘
- kcloud_platform_snail_job.sql ã€Snail Jobã€‘

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_2.png">

æ³¨æ„ï¼š<font color="red">ä¸åŒçš„æ•°æ®åº“æ‰§è¡Œä¸åŒçš„SQLæ–‡ä»¶ </font>

æ³¨æ„ï¼š<font color="red">ä¸åŒçš„æ•°æ®åº“æ‰§è¡Œä¸åŒçš„SQLæ–‡ä»¶ </font>

æ³¨æ„ï¼š<font color="red">ä¸åŒçš„æ•°æ®åº“æ‰§è¡Œä¸åŒçš„SQLæ–‡ä»¶ </font>

ğŸš€ ä¿®æ”¹pom.xmlé…ç½®ï¼Œä¿®æ”¹æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼Œå…¶ä»–ä¿¡æ¯é»˜è®¤å³å¯

æ³¨æ„ï¼š<font color="red">å…ˆè·‘èµ·æ¥ï¼Œä¸è¦æ”¹ä»»ä½•çš„å¯†ç ï¼Œè¯·ä¸è¦æ“…ä½œä¸»å¼ çš„ä¿®æ”¹ï¼Œå¦‚æœç…§ç€æ•™ç¨‹è¿è¡Œï¼Œè¿˜æœ‰é—®é¢˜è¯·è”ç³»ä½œè€…</font>

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_3.png">

ğŸš€ è¿è¡Œlaokou-nacosï¼Œå¯åŠ¨å•æœºNacosï¼ˆéœ€è¦é…ç½®VM Optionï¼‰

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_4.png">

```shell
-Xmx512m
-Xms512m
-Dnacos.standalone=true
-Dnacos.home=./logs/nacos
```

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_5.png">

ğŸš€ è®¿é—® <a href='http://localhost:8848/nacos'>Nacosæ§åˆ¶å°</a>ï¼Œåˆ›å»ºå‘½åç©ºé—´ï¼ˆå¦‚æœ‰éœ€è¦è‡ªè¡Œä¿®æ”¹å³å¯ï¼‰

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_6.png">

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_7.png">

ğŸš€ å…ˆè¿è¡Œlaokou-authã€ç„¶ålaokou-gatewayã€æœ€ålaokou-adminã€æœ‰å…ˆåé¡ºåºï¼Œè¯·æŒ‰ç…§æ­¥éª¤ã€‘

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_8.png">

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_9.png">

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_10.png">

ğŸš€ è®¿é—®APIæ–‡æ¡£

ç½‘å…³æœåŠ¡ï¼šhttp://gateway:5555/doc.html

è®¤è¯æœåŠ¡ï¼šhttp://auth:1111/doc.html

ç®¡ç†æœåŠ¡ï¼šhttp://admin:9990/doc.html

<img src="/img/é¡¹ç›®å¯åŠ¨ã€devç¯å¢ƒã€‘/img_12.png">

æˆ‘æ˜¯è€å¯‡ï¼Œæˆ‘ä»¬ä¸‹æ¬¡å†è§å•¦ï¼
